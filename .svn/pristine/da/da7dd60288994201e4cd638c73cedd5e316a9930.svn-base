# 淘宝技术总结

## 淘宝技术的发展

### 个人网站

LAMP 

    团队:三个开发(虚竹,三丰,多隆), 一个UED(二当家), 三个运营(小宝,阿 珂,破天), 一个经理(财神), 马云和秘书。
    当时的竞争对手eBuy, 易趣
    最初采用LAMP(Linux + Apache + MySQL + PHP)结构, 第一个网站PHPAuction是从 http://www.phpauction.net 买的, 最初结构如下图

<div align=center>
<img src="imgs/Snipaste-2019-05-29_00-59-39.png"height="300px">
</div>

    pear DB是PHP的模块, 负责数据访问层  
> LAMP 结构补充
<div align=center>
<img src="imgs/lampstructure.png" height="300px">
<img src="imgs/lampstructure2.png" height="300px">
</div>

    2003年, 淘宝由最初的1台服务器增至3台, 一台负责发送Email、一台负责运行数据库、一台负责运行 WebApp
    2003年7月, 多隆又把阿里巴巴中文站 的搜索引擎iSearch搬了过来

> 相关问题

    随着访问量和数据量的飞速上涨, MySQL当时是第4版的，我们用的是默 认的存储引擎MyISAM，这种存储引擎在写数据的时候会把表锁 住。当Master同步数据到Slave的时候，会引起Slave写，这样在Slave 的读操作都要等待。还有一点是会发生Slave上的主键冲突，经常会 导致同步停止,当年的MySQL不比如今的MySQL，在数据的容 量和安全性方面也有很多先天的不足（和Oracle相比）

> 策略

    2003年底, 访问量和交易量迅速上涨, MySQL已经撑不住了，技术的替代方案非常 简单，就是换成Oracle。换为Oracle的原因除了它容量大、稳定、 安全、性能高之外，还有人才方面的原因。在2003年的时候，阿 里巴巴已经有一支很强大的DBA团队了，有鲁国良、冯春培、 汪海（七公）这样的人物，后来还有冯大辉（@fenng）、陈吉 平（拖雷）

> 相关问题

    换库不仅仅是换个数据库, 其访问方式和SQL都要变  
    Oracle的性能和并发访问能力 之所以如此强大，有一个关键性的设计——连接池，连接池中放 的是长连接，是进程级别的，在创建进程的时候，它就要独占一部分内存空间
    而PHP对数据库的访问是很直接的, 每一个请求就是一个连接  ---------------   引入开源连接池代理服务SQL Relay(由多隆进行改造), 结构如下

<div align=center>
<img src="imgs/Snipaste-2019-05-29_01-26-31.png" height="300px">
</div>

    采用NAS+Oracle RAC实现负载均衡, 后来发现NAS的NFS（Network File System）协议传输的延迟很严重  ---    换用了Dell和EMC合作的SAN低端存储  
    存储节点才分导致RAC出问题  -----  换用了小型机
    SQL Relay 内部逻辑不对, 代理服务器经常死锁  -----  每天重启

> **任何牛B的人物，都有一段苦B的经历**

### Java时代



### 创造技术

### 分布式时代

### 中间件

### Session框架

### 开放平台



